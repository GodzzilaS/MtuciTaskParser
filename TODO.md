# TODO

## 1. Спарсить LMS-страницы (services/scraper.py)

- [x] Реализовать авторизацию на странице `core.settings.LOGIN_PAGE`
- [ ] Обработка ошибок авторизации и неверных учётных данных
- [x] Навигация к странице курсов (`MY_COURSES_PAGE`) и ожидание загрузки элементов
- [x] Переключение на карточный режим отображения (`_ensure_card_view`)
- [x] Извлечение списка курсов (BeautifulSoup-селекторы)
- [x] Парсинг данных:
    - [x] Название курса и задания
    - [x] Дата открытия и крайний срок
    - [x] Статус отправки
    - [x] Статус оценки
- [x] Логирование шагов парсинга (`logging`)

## 2. Создать и настроить Telegram‑бота (main.py, bot/handlers.py)

- [x] Реализовать команды и выкинуть их в асинхронный поток:
    - [x] `/login` – ввод и шифрование учётных данных (Fernet)
    - [x] `/get_tasks` – вывод текущих заданий
    - [x] `/get_timetable` – вывод текущего расписания на месяц
    - [x] Вызовы к `Scraper` через `asyncio.to_thread`
    - [x] Обработка исключений и таймаутов
- [x] Хранение данных в MongoDB:
    - [x] CRUD пользователей (`core/models/users.py`)
    - [x] CRUD заданий (`core/models/tasks.py`)
- [x] Фоновая задача `background_check` (scheduler.py):
    - [x] Запуск в отдельном потоке/цикле
    - [x] Интервал проверки — каждые 5 минут
    - [x] Отправка уведомлений при изменениях статусов
- [x] Замер времени выполнения команд (`measure_duration`)
- [x] Логирование команд и ошибок
- [ ] Привязать notification_enable к реальным показателям

## 3. Добавить веб‑админку на Flask (webapp/, utils/blueprints_utils.py)

- [x] Скелет Flask‑приложения + middleware логирования (`CustomLogMiddleware`)
- [x] Blueprint `main` (webapp/routes.py):
    - [x] Страница списка пользователей:
        - [ ] Фильтры по telegram_id, username, курсу, группе
        - [ ] Кнопки «Удалить», «Отключить/Включить уведомления»
    - [x] Управление флагами:
        - [x] `bot_enabled`
        - [x] `maintenance_mode`
        - [x] `scheduled_enabled`
- [x] Интеграция с моделями (`core/models`) для CRUD
- [ ] Документация API админки в README

## 4. Расширенные функции и улучшения

### 4.1. Просмотр и управление задачами пользователей

- [ ] Добавить таблицу всех заданий с фильтрами (дата, статус, курс/группа)
- [ ] Реализовать ручное обновление статуса задания из админки

### 4.2. Дашборд и метрики

- [ ] Показать число активных пользователей
- [ ] График изменений заданий/уведомлений за период

### 4.3. Логи и мониторинг

- [ ] Страница последних N записей логов (INFO/WARN/ERROR)
- [ ] Возможность скачать или очистить старые логи

### 4.4. Ручной запуск фоновой проверки

- [ ] Кнопка «Запустить сейчас» для `background_check`
- [ ] Отображение результатов последнего запуска (изменения, количество уведомлений)

### 4.5. Расширенное управление пользователями

- [ ] Фильтрация и поиск по telegram_id, username, группе
- [ ] Массовые операции: включить/выключить уведомления, удалить нескольких пользователей

### 4.6. !! Имперсонация пользователя !!

- [ ] Функция вызова команд из под другого пользователя в целях тестирования и просмотра ответов

### 4.7. Гибкая настройка расписания

- [ ] Интерфейс для изменения интервала фоновой проверки

### 4.8. Настройка уведомлений

- [ ] Вынести все уведомления в другое хранилище, что бы их можно было редактировать с сайта
- [ ] Добавить альтернативные каналы уведомлений (email, веб‑хуки)
