{% extends 'base.html' %}
{% block title %}–ó–∞–¥–∞—á–∏{% endblock %}
{% block content %}

  <div class="card">
    <h2>üìã –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á</h2>

    <form method="get" class="button-submit-panel" style="margin-top: 1rem;">
      <div class="input-group" style="margin-bottom: 0 !important">
        <input type="text" name="user_id" placeholder="ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" value="{{ filters.get('user_id','') }}">
      </div>
      <div class="input-group" style="margin-bottom: 0 !important">
        <input type="text" name="course" placeholder="–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞" value="{{ filters.get('course','') }}">
      </div>
      <div class="input-group select-wrapper" style="margin-bottom: 0 !important">
        <select name="response_status">
          <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã –æ—Ç–≤–µ—Ç–∞</option>
          {% for st in ['–û—Ç–≤–µ—Ç—ã –Ω–∞ –∑–∞–¥–∞–Ω–∏–µ –µ—â–µ –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã','–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –¥–ª—è –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è'] %}
            <option value="{{ st }}" {% if filters.get('response_status') == st %}
                    selected {% endif %}>{{ st }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="input-group select-wrapper" style="margin-bottom: 0 !important">
        <select name="grade_status">
          <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã –æ—Ü–µ–Ω–∫–∏</option>
          {% for st in ['–ù–µ –æ—Ü–µ–Ω–µ–Ω–æ','–û—Ü–µ–Ω–µ–Ω–æ'] %}
            <option value="{{ st }}" {% if filters.get('grade_status') == st %} selected {% endif %}>{{ st }}</option>
          {% endfor %}
        </select>
      </div>
      <button type="submit" class="btn-toggle">–§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å</button>
    </form>

    <div class="users-list" style="margin-top: 2rem;">
      {% for task in tasks %}
        <div class="user-card">
          <div class="user-info">
            <strong>ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</strong> {{ task.user_id }} |
            <strong>–ó–∞–¥–∞—á–∞:</strong> <a class="telegram-link" href="{{ task.task_link }}" target="_blank">
            {{ task.task_name }}</a>
          </div>
          <div class="user-info">
            <strong>–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞:</strong> {{ task.course }}
          </div>
          <div class="user-info">
            üìÖ <strong>–ù–∞—á–∞—Ç–æ:</strong> {{ task.open_date }} |
            <strong>–ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è:</strong> {{ task.due_date }}
          </div>
          <div class="user-info">
            <strong>–°—Ç–∞—Ç—É—Å:</strong> üì® {{ task.response_status }} | üèÅ {{ task.grade_status }}
          </div>
          <form action="{{ url_for('tasks.update_task', task_id=task.uuid) }}?{{ request.query_string|safe }}"
                method="post"
                class="button-submit-panel">
            <div class="select-wrapper">
              <select name="response_status">
                {% for st in ['–û—Ç–≤–µ—Ç—ã –Ω–∞ –∑–∞–¥–∞–Ω–∏–µ –µ—â–µ –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã','–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –¥–ª—è –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è'] %}
                  <option value="{{ st }}" {% if task.response_status== st %}selected{% endif %}>{{ st }}</option>
                {% endfor %}
              </select>
            </div>
            <div class="select-wrapper">
              <select name="grade_status">
                {% for st in ['–ù–µ –æ—Ü–µ–Ω–µ–Ω–æ','–û—Ü–µ–Ω–µ–Ω–æ'] %}
                  <option value="{{ st }}" {% if task.grade_status== st %}selected{% endif %}>{{ st }}</option>
                {% endfor %}
              </select>
            </div>
            <button type="submit" class="btn-toggle">–û–±–Ω–æ–≤–∏—Ç—å</button>
          </form>
        </div>
      {% endfor %}
    </div>
  </div>
{% endblock %}
